@model MyCalendar.Website.ViewModels.SettingsVM
@using MyCalendar.Website.ViewModels
@{
    var BaseViewModel = ViewData[nameof(BaseVM)] as BaseVM;
}

<div id="accordion">
    @Html.Partial("_Status", BaseViewModel)
    <div class="card">
        <div class="card-header" id="headingOne">
            <h7 class="mb-0">
                <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                    <h4 class="glyphicon glyphicon-user"> Profile</h4>
                </button>
            </h7>
        </div>

        <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
            <div class="card-body">
                @using (Html.BeginForm())
                {
                    <div class="form-group">
                        @Html.LabelFor(x => x.User.Name)
                        @Html.TextBoxFor(s => s.User.Name, new { @class = "form-control", @type = "text", @placeholder = "Name", @required = "required" })
                    </div>
                    <div class="form-group">
                        @Html.LabelFor(x => x.User.Passcode, "Login Passcode") <font color="red"><small>(changing this will log you out)</small></font>
                        @Html.TextBoxFor(s => s.User.Passcode, new { @class = "form-control", @type = "number", @placeholder = "Passcode", @required = "required" })
                    </div>
                    <div class="form-group">
                        @Html.LabelFor(x => x.User.Email)
                        @Html.TextBoxFor(s => s.User.Email, new { @class = "form-control", @type = "text", @placeholder = "Email" })
                    </div>
                    <div class="form-group">
                        @Html.LabelFor(x => x.User.PhoneNumber)
                        @Html.TextBoxFor(s => s.User.PhoneNumber, new { @class = "form-control", @type = "text", @placeholder = "Phone number" })
                    </div>
                    <div class="form-group">
                        @Html.CheckBoxFor(s => s.User.EnableCronofy)
                        <span>Enable MiCalendar Sync</span>
                    </div>
                    @Html.HiddenFor(x => x.User.UserID)
                    @Html.HiddenFor(x => x.User.CronofyUid)
                    @Html.HiddenFor(x => x.User.AccessToken)
                    @Html.HiddenFor(x => x.User.RefreshToken)
                    @Html.HiddenFor(x => x.User.ExtCalendars)
                    <button type="submit" class="btn btn-primary">Update</button>
                }
            </div>
        </div>
    </div>
    <div class="card">
        <div class="card-header" id="headingTwo">
            <h7 class="mb-0">
                <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    <h4 class="glyphicon glyphicon-tags"> Tags</h4>
                </button>
            </h7>
        </div>
        <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
            <div class="card-body">
                @Html.Partial("_Tags", new MyCalendar.DTOs.TagsDTO { Tags = BaseViewModel.UserTags.Tags, Types = Model.Types, UserID = Model.User.UserID })
            </div>
        </div>
    </div>

</div>


@section Scripts{
    <script type="text/javascript">
        $(document).ready(function () {
            $(".add-more").click(function () {
                var html = $(".copy").html();
                $(".after-add-more").after(html);
            });

            $("body").on("click", ".remove", function () {
                $(this).parents(".control-group").remove();
            });
        });
    </script>
}